
---
title: "Home Field Advantage — English Premier League"
author: "Group 4: Luca Guerra, Ryan Jingwi"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    number_sections: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
library(tidyverse)
library(lubridate)
```
# Abstract

The **home-field advantage** phenomenon has always been intriguing to players and fans, with the English Premier League (EPL) being the most watched, cheered and analyzed soccer league in the world. This research study investigates whether home advantage means a real competitive advantage in match win/loss results, goals scored, and points attained. Utilizing over 11,000 matches from the past 30 EPL seasons, we use exploratory data analysis (EDA) augmented by inferential statistics including t-tests. What we find is persistent home bias—home teams win more often, score more goals, and have higher points per game (PPG)—but that this has reduced slightly in the recent past, particularly during the time of the COVID-19 pandemic when crowds were reduced or even absent. The study concludes that while home-field advantage remains statistically significant, its impact becomes more contextual and conditioned by external variables such as crowd reaction and team strength.

# Introduction

Soccer games can be decided by many factors, not just skills and strength: the environment including sound, climate, humidity, lighting and any other factor can play a role in a match outcome. What we want to find out in this research is to what degree the home team can be advantaged playing in their home structure, with their home climate and environment, and with their home fans.
The presence of a home field advantage is already visible by just watching a soccer game, with the home team usually being more offensive and pushing to score a goal, but it's hard to quantify this effect without using the proper data analysis and statistical testing. Our dataset offers an ideal case study to try to answer our SMART question:

**Does playing at home significantly increase a Premier League team’s likelihood of winning, scoring more goals, and earning more points per game between 1993 and 2022?**

We hypothesize that home teams perform significantly better on average across these metrics, but that the effect may have weakened in recent years due to tactical and technical evolution and covid-related restrictions. This project combines exploratory data visualization with inferential tests to evaluate the strength and evolution of this effect.

# Literature review

In past research, Courneya and Carron (1992) were among the first to popularize meta-analysis with crowd support, hometown favoritism, travel fatigue, and referee's bias as the most critical factors. Subsequent studies (Pollard, 2008) confirmed its existence in various sports and leagues and quantified the average home superiority at approximately 60% winning percentages in soccer. Later studies have investigated its psychological underpinning: Nevill and Holder (1999) found that the size of the crowd and the level of noise influence referee decisions, and Bryson et al. (2021) observed a significant decline in home advantage during COVID-19, when games were played without spectators.

Blind to these results, though, is most of the prior work that posits a single mechanism across an exhaustive quantitative synthesis. This paper seeks to correct that by bringing empirical findings (win ratios, goals, points) together with statistical testing and temporal trends. The EPL is a natural experiment because it has a long history, uniform structure, and competitive equilibrium.



# The Dataset

```{r read-data}
df <- read_csv("C:/Users/Luca/OneDrive/Desktop/DATS/Intro to data sci/results.csv", locale = locale(encoding = "latin1"))
```

We used the "English Premier League (EPL) Results" dataset by the user "Alvin" on kaggle.com consisting of 11,113 observations of premier league games results and statistics from 1993 to 2022. The observed variables are:

- Season: soccer season of the game (ex. 2020/2021)
- DateTime: date of the game in yyyy-mm-dd
- HomeTeam: full name of the home team (50 total unique teams)
- AwayTeam: full name of the away team (50 total unique teams)
- FTHG: number of goals scored by the Home Team at the end of the match
- FTAG: number of goals scored by the Away Team at the end of the match
- FTR: Full time result, "A" for games won by the away team, "D" for games ended in a draw, "H" for games won by the Home Team
- HTHG: number of goals scored by the Home Team at halftime
- HTAG: number of goals scored by the Away Team at halftime
- HTR: result at halftime, same method as FTR
- Referee: name of the referee if known
- HS: number of shots by the home team
- AS: number of shots by the away team
- HST: number of shots on target by the home team (<=HS)
- AST: number of shots on target by the away team (<=AS)
- HC: number of corners for the home team
- AC: number of corners by the away team
- HF: number of fouls committed by the home team
- AF: number of fouls committed by the away team
- HY: number of yellow cards shown to the home team
- AY: number of yellow cards shown to the away team
- HR: number of red cards shown to the home team
- AR: number of red cards shown to the away team



To find out a potential home advantage, we will consider only the final scores and ignore the halftime, fouls, shots, cards and referee data for this purpose. Other effects can be explored in a second analysis using the statistics, to find out if referees can be biased by a field effect too. 


```{r}
str(df)

```

# Data Cleaning and Preparation

Before starting our data analysis, we must ensure that the dataset doesn't contain major inconsistencies, outliers, and missing values (NAs). The EPL data is relatively clean, as specified by the author, but small data quality issues—missing score entries can bias statistical inference and we want to keep the dataset representative of the actual population and ensure robustness.

```{r}

df <- filter(
  drop_na(df, FTHG, FTAG, FTR),
  between(FTHG, quantile(df$FTHG, 0.25, na.rm = TRUE) - 1.5 * IQR(df$FTHG, na.rm = TRUE), quantile(df$FTHG, 0.75, na.rm = TRUE) + 1.5 * IQR(df$FTHG, na.rm = TRUE)),
  between(FTAG, quantile(df$FTAG, 0.25, na.rm = TRUE) - 1.5 * IQR(df$FTAG, na.rm = TRUE), quantile(df$FTAG, 0.75, na.rm = TRUE) + 1.5 * IQR(df$FTAG, na.rm = TRUE))
)

```


# Initial EDA – Match Outcomes

## Home vs Away: Outcome Breakdown


```{r}
outcomes <- mutate(
  count(mutate(df,Result = case_when(
        FTR == "H" ~ "HomeWin",
        FTR == "A" ~ "AwayWin",
        FTR == "D" ~ "Draw",
        TRUE ~ "Other"
      )),Result),pct = n / sum(n) * 100)

outcomes

```


```{r}
ggplot(outcomes, aes(x = Result, y = pct, fill = Result)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = paste0(round(pct,1), "%")), vjust = -0.5) +
  labs(title = "Home vs Away: Outcome Breakdown",
       x = "", y = "% of matches") +
  theme_minimal()
```

From a raw plotting of the percentages of win/draw/loss outcomes we can already tell that home teams win 41.6% of the games, against a 30.5% by the away teams. Considering that each team faces every opponent one time home and one time away, this already suggests that a home effect might be present.


## Do Home Teams Score More Goals?

```{r}
goal_stats <- summarize(
  df,
  avg_home_goals = mean(FTHG, na.rm = TRUE),
  avg_away_goals = mean(FTAG, na.rm = TRUE)
)

goal_stats
```

```{r}
df2 <- mutate(df, goal_diff = FTHG - FTAG)

ggplot(df2, aes(x = goal_diff)) +
  geom_histogram(binwidth = 1, boundary = -0.5) +
  labs(title = "Histogram of Goal Differences (Home - Away)",
       x = "Goal difference (Home - Away)", y = "Count") +
  theme_minimal()
```

In terms of goals scored, we can see a slightly larger average for home teams and a right-skewed histogram, suggesting that the home teams tend to score more. Since our goals scored variables contain only integers and most of them are 0,1 and 2, our analysis is limited to this plot and average.

## Points Per Game (PPG): Home vs Away

```{r}

df_points <- mutate(
  df,
  home_points = case_when(
    FTR == "H" ~ 3,
    FTR == "D" ~ 1,
    FTR == "A" ~ 0,
    TRUE ~ NA_real_
  ),
  away_points = case_when(
    FTR == "A" ~ 3,
    FTR == "D" ~ 1,
    FTR == "H" ~ 0,
    TRUE ~ NA_real_
  )
)

ppg_summary <- summarize(
  df_points,
  avg_home_ppg = mean(home_points, na.rm = TRUE),
  avg_away_ppg = mean(away_points, na.rm = TRUE)
)

ppg_summary
```

```{r}
ppg_plot <- mutate(
  pivot_longer(
    ppg_summary,
    everything(),
    names_to = "side",
    values_to = "ppg"
  ),
  side = recode(side, "avg_home_ppg" = "Home", "avg_away_ppg" = "Away")
)

ggplot(ppg_plot, aes(x = side, y = ppg, fill = side)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = round(ppg, 2)), vjust = -0.5) +
  labs(title = "Average Points per Match: Home vs Away", x = "", y = "Avg PPG") +
  theme_minimal()
```

In soccer, a win gives 3 points to a team, a draw one point, and zero points for a loss. Starting from this rule, we analized the average points per game for home teams vs away teams, where again all teams have the same number of games played at home and away, being this number balanced for each season. We can notice that home teams gain, on average, 0.34 points more playing home than away.


## Has Home Advantage Changed Over Time?

```{r}
season_summary <- arrange(
  summarize(
    group_by(
      mutate(df_points, Season = as.character(Season)),
      Season
    ),
    matches = n(),
    pct_home_wins = mean(FTR == "H") * 100,
    avg_home_ppg = mean(home_points, na.rm = TRUE),
    avg_away_ppg = mean(away_points, na.rm = TRUE),
    ppg_diff = avg_home_ppg - avg_away_ppg
  ),
  Season
)

season_summary
```

```{r}
ggplot(season_summary, aes(x = as.integer(substr(Season,1,4)), y = pct_home_wins)) +
  geom_line() + geom_point() +
  labs(title = "% Home Wins per Season", x = "Season (first year)", y = "% Home Wins") +
  theme_minimal()
```

```{r}
ggplot(season_summary, aes(x = as.integer(substr(Season,1,4)), y = ppg_diff)) +
  geom_line() + geom_point() +
  labs(title = "Difference in Home vs Away PPG per Season (Home - Away)",
       x = "Season (first year)", y = "PPG Difference") +
  theme_minimal()
```


We can notice that home advantage has been slightly shrinking in recent years, in both winning percentages and PPG differences, with a drop even below zero during covid-19 impacted seasons.

# T test

```{r}
library(dplyr)

df$home_win <- ifelse(df$FTR == "H", 1, 0)
df$away_win <- ifelse(df$FTR == "A", 1, 0)

home_rates <- aggregate(home_win ~ HomeTeam, data = df, FUN = mean, na.rm = TRUE)
names(home_rates) <- c("team", "home_winrate")

away_rates <- aggregate(away_win ~ AwayTeam, data = df, FUN = mean, na.rm = TRUE)
names(away_rates) <- c("team", "away_winrate")

team_rates <- merge(home_rates, away_rates, by = "team")

t_test <- t.test(team_rates$home_winrate,
                 team_rates$away_winrate,
                 paired = TRUE,
                 alternative = "greater")

t_test

boxplot(team_rates$home_winrate, team_rates$away_winrate,
        names = c("Home", "Away"),
        ylab = "Win Rate",
        main = "Premier League: Home vs Away Win Rates")

team_rates$avg_winrate <- (team_rates$home_winrate + team_rates$away_winrate) / 2
team_rates_sorted <- team_rates[order(team_rates$avg_winrate), ]
top_teams <- head(team_rates_sorted, 10)
worst_teams <- tail(team_rates_sorted, 10)
top_worst_teams <- rbind(top_teams, worst_teams)

top_worst_long_home <- top_worst_teams[, c("team", "home_winrate")]
top_worst_long_home$location <- "Home"
names(top_worst_long_home) <- c("team", "winrate", "location")

top_worst_long_away <- top_worst_teams[, c("team", "away_winrate")]
top_worst_long_away$location <- "Away"
names(top_worst_long_away) <- c("team", "winrate", "location")

top_worst_long <- rbind(top_worst_long_home, top_worst_long_away)

top_worst_long <- merge(top_worst_long, top_worst_teams[, c("team", "avg_winrate")], by = "team")
top_worst_long <- top_worst_long[order(-top_worst_long$avg_winrate, top_worst_long$location), ]


barplot(
  top_worst_long$winrate,
  names.arg = top_worst_long$team,
  col = ifelse(top_worst_long$location == "Home", "skyblue", "salmon"),
  ylab = "Win Rate",
  main = "Top 10 and Worst 10 Teams: Home vs. Away Win Rate",
  las = 2 # Rotate x-axis labels
)
legend("topright",
       legend = c("Home", "Away"),
       fill = c("skyblue", "salmon"))


```

We then found 2 win rates for each team, one for the home games and one for the away ones visible in the boxplot above. We also show the same rates for the top ten and worst ten teams by win rates. We can see from both the boxplot and the histogram that an effect is present for a bigger win rate in home games, and that this effect is almost equally present in title contender teams as well as relegation teams. We also ran a T-test on the home win rate and the away win rate, that showed a significant difference between the 2 means, allowing us to affirm that a home advantage effect is present and significant.


# Possible Explanations

Many factors can contribute to the hom advantage effect, ranging from the crowd, the stadium structure and services, the locker rooms design, the climate (being played outdoor), the travel fatigue, biased referees, or many others. In particular, this dataset allows exploration on referees and cards too, to assess a potential home effect on fouls and sanctions too. 


# Conclusion

Data shows consistent advantage for home teams, with higher win rates, more goals scored, and more points gained. The t-test confirmed a significant presence of a home-advantage in the English Premier League, but this advantage is shown to be slightly shrinking over time. We can therefore answer affirmatively to our smart question, even though the context and causes of the effect can still be explored.



# References


- User "Alvin" *English Premier League (EPL) Results: Premier League Results from 1993-94 to 2021-22* https://www.kaggle.com/datasets/irkaal/english-premier-league-results
- Bryson, A., Dolton, P., Reade, J. J., Schreyer, D., & Singleton, C. (2021). *Causal effects of an absent crowd on performances and refereeing decisions during COVID-19.* *Economics Letters*, 198, 109664.  
- Courneya, K. S., & Carron, A. V. (1992). *The home advantage in sport competitions: A literature review.* *Journal of Sport & Exercise Psychology*, 14(1), 13–27.  
- Nevill, A. M., & Holder, R. L. (1999). *Home advantage in sport: An overview of studies on the advantage of playing at home.* *Sports Medicine*, 28(4), 221–236.  
- Pollard, R. (2008). *Home advantage in football: A current review of an unsolved puzzle.* *The Open Sports Sciences Journal*, 1, 12–14.  
- Goumas, C. (2014). *Home advantage in Australian soccer.* *PLoS ONE*, 9(9), e105041.

